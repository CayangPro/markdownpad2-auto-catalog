/*
|--------------------------------------------------------------------------
| MarkdownPad2 编辑器导出 html 文件时自动生成左侧目录插件
|--------------------------------------------------------------------------
|
| 此插件用于将在 MarkdownPad2 编辑器中编辑的文档在转为 Html文件时自动生成左侧目录
| 目录生成时默认将第一个 h1 标签作为文档的题目，当检测到有多个 h1 标签时，
| 会将除了第一个 h1 外的所有 h1 标签自动转换为 h2 标签，其余标签自动向下转一级
| 实现的功能：
| 1. 根据 Html 文档中 h1~h6 标签自动生成对应的目录
| 2. 自动生成目录编号，可选择是否显示目录编号
| 3. 目录搜索功能，全文搜索使用浏览器自带的 Ctrl+F
| 4. 提供三种目录样式，可自由选择
| 5. 提供白天和夜间 2 种阅读模式
| 6. 根据当前阅读位置，自动显示所在目录及父级目录
| 7. 一键展开收起目录列表
| 8. 整个左侧栏目可展开和收起
|
| 作者: YXC (cayang512@163.com )
| GitHub https://github.com/cayxc/MarkdownPad2AutoCatalog
| Gitee  https://gitee.com/cayxc/MarkdownPad2AutoCatalog
|
*/
!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="dist/",n(n.s=0)}([function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};window.onload=function(){function e(){var e=document.body.innerHTML;document.body.innerHTML="",document.body.style.overflow="hidden";var t=document.createElement("div"),n=document.createElement("div");t.id="left-container",n.id="right-container",t.innerHTML='\n<div class="top-container">\n        <i class="catalog-button iconfont icon-catalogOpen"></i>\n        <div class="search-container">\n            <input type="text" class="search" name="search" placeholder="输入关键字搜索 . . .">\n            <i class="search-icon iconfont icon-cancel"></i>\n        </div>\n        <div class="search-result"></div>\n    </div>\n    <div id="list-container">\n        <div class="list-wrapper">\n        </div>\n    </div>\n    <div class="bottom-container">\n        <div class="mode-container">\n            <div class="mode">\n                <i class="iconfont icon-sun"></i>\n            </div>\n            <div class="index">\n                <i class="iconfont icon-indexA"></i>\n            </div>\n            <div class="structure">\n                <i class="iconfont icon-process"></i>\n                <ul class="structure-child">\n                    <li>\n                        <input type="radio" id="styleA" name="catalogStyle" value="1" checked="checked">\n                        <label for="styleA">样式 A</label>\n                    </li>\n                    <li>\n                        <input type="radio" id="styleB" value="2" name="catalogStyle">\n                        <label for="styleB">样式 B</label>\n                    </li>\n                    <li>\n                        <input type="radio" id="styleC" value="3" name="catalogStyle">\n                        <label for="styleC">样式 C</label>\n                    </li>\n                </ul>\n            </div>\n            <div class="color" style="display: none;">\n                <i class="iconfont icon-color"></i>\n                <div class="color-child">\n                    <span>自定义颜色</span>\n                    <input type="color">\n                </div>\n            </div>\n        </div>\n    </div>\n   <div id="switch-button">\n   <i class="iconfont icon-arrLeft"></i>\n   </div>\n',n.innerHTML='\n<div id="content">\n'+e+"\n</div>\n</div>\n",document.body.appendChild(t),document.body.appendChild(n);!function(e,t,n){if("string"!=typeof e||"string"!=typeof t||"string"!=typeof n)return void console.log("noteTips() 调用时参数类型错误！");var o=document.createElement(e);o.innerHTML=t,document.getElementById(n).appendChild(o)}("div",'\n<p class="note-tips">\n 本文档经过 MarkdownPad2AutoCatalog 目录生成插件转换生成&emsp;作者： cayang512@163.com&emsp;插件详情：&emsp;<a href="https://github.com/cayxc/MarkdownPad2AutoCatalog" target="_blank"> GitHub地址</a>&emsp;<a href="https://gitee.com/cayxc/MarkdownPad2AutoCatalog" target="_blank">Gitee地址</a></p>\n',"content")}function t(e){if("object"==(void 0===e?"undefined":o(e)))return Number(e.nodeName.slice(1));console.log("getTagNumber() 调用时参数类型错误，必须是一个h标签的对象集合！")}function n(e,t){if("string"==typeof e&&"string"==typeof e){for(var n=e.indexOf(t),o=0;-1!==n;)o++,n=e.indexOf(t,n+1);return o}console.log("findStrFre() 调用时参数类型错误！")}function i(e){if(e<1||e>5||"number"!=typeof e)console.log("levelTagArr() 调用时参数类型错误！");else{for(var t=document.querySelectorAll("h2,h3,h4,h5,h6"),o=[],i=[],c=[],l=[],r=[],s=0,a=t.length;s<a;s++){switch(n(t[s].id,".")){case 0:o.push(t[s]);break;case 1:i.push(t[s]);break;case 2:c.push(t[s]);break;case 3:l.push(t[s]);break;case 4:r.push(t[s]);break;default:return}}switch(e){case 1:return o;case 2:return i;case 3:return c;case 4:return l;case 5:return r;default:return}}}function c(e){if("object"==(void 0===e?"undefined":o(e))){var t=e.id;if(-1==t.lastIndexOf("."))return"level-"+(parseInt(t.slice(6))+1);var n=t.lastIndexOf(".");return t.slice(0,n)+"."+(parseInt(t.slice(n+1))+1)}console.log("setLevelNumber() 调用时参数类型错误，必须是一个h标签的对象集合！")}function l(){!function(){var e=document.querySelectorAll("h1");if(e.length>1){for(var t=document.querySelectorAll("h2,h3,h4,h5"),n=1,o=e.length;n<o;n++){var i=document.createElement("h2");i.innerHTML=e[n].innerHTML,e[n].parentNode.replaceChild(i,e[n])}for(var c=0,l=t.length;c<l;c++){var r="h"+(parseInt(t[c].nodeName.slice(1))+1),s=document.createElement(r);s.innerHTML=t[c].innerHTML,t[c].parentNode.replaceChild(s,t[c])}}}();var e=document.querySelectorAll("h2,h3,h4,h5,h6"),n=e.length;if(0!=n){if(1==n&&(e[0].id="level-1"),n>1){e[0].id="level-1";var o=t(e[1])-t(e[0]);e[1].id=o<=0?c(e[0]):e[0].id+".1";for(var i=2,l=n-1;i<l;i++){var r=t(e[i]),s=t(e[i-1]);if(r<s)for(var a=i-1;a>=0;a--){var u=t(e[a])-r;if(1==u){if(!(a>0)){e[i].id=c(e[a]);break}if(t(e[a-1])==r){e[i].id=c(e[a-1]);break}}if(0==u){e[i].id=c(e[a]);break}}r>s&&(e[i].id=e[i-1].id+".1"),r==s&&(e[i].id=c(e[i-1]))}if(n>2){var d=document.querySelectorAll(e[n-1].nodeName);d.length>1?e[n-1].id=c(d[d.length-2]):e[n-1].id=e[n-2].id+".1"}}}else document.querySelector(".list-wrapper").innerHTML='<ul>\n<li style="text-align:center;color: #ccc;font-size:14px;">\n抱歉...<br/>文档中未发现 h1~h6 标签<br/>无法生成目录</p>\n</li>\n</ul>\n'}var r=!1;r||(e(),function(){l();for(var e=document.querySelector(".list-wrapper"),t=document.createElement("ul"),n=1;n<=5;n++){var o=i(n),c=o.length;if(0==c)break;if(1==n)for(var r=0,s=c;r<s;r++){var a=document.createElement("li");a.innerHTML='\n<a href="'+window.location.href+"#"+o[r].id+'" class='+o[r].id+">\n<p>"+o[r].id.slice(6)+"</p>\n<span>"+o[r].innerText+"</span></a>\n",t.appendChild(a),e.appendChild(t)}if(n>1)for(var u=0,d=c;u<d;u++)for(var f=i(n-1),p=0,h=f.length;p<h;p++)if(o[u].id.slice(6,o[u].id.lastIndexOf("."))==f[p].id.slice(6)){var v=f[p].id,m=document.getElementsByClassName(v)[0].parentNode;m.setAttribute("class","parent-level");var b=document.createElement("li");b.innerHTML='\n<a href="'+window.location.href+"#"+o[u].id+'" class='+o[u].id+">\n<p>"+o[u].id.slice(6)+"</p>\n<span>"+o[u].innerText+"</span></a>\n";var y=m.querySelector("ul");if(null!==y)y.appendChild(b);else{(y=document.createElement("ul")).setAttribute("class","js-open"),y.appendChild(b),m.appendChild(y);var g=document.createElement("i");g.setAttribute("class","iconfont icon-openA"),m.insertBefore(g,m.childNodes[0])}break}}}(),document.querySelector(".list-wrapper").querySelector("li").classList.add("js-active"),r=!0);var s,a=document.querySelector("#left-container"),u=document.querySelector("#right-container"),d=document.querySelector("#content"),f=document.querySelector(".top-container"),p=document.querySelector(".list-wrapper"),h=document.querySelector("#switch-button"),v=document.querySelector(".catalog-button"),m=document.querySelector(".mode"),b=p.children[0].querySelectorAll("i"),y=p.children[0].querySelectorAll("ul"),g=p.querySelectorAll("a");function A(e){if("object"!==(void 0===e?"undefined":o(e)))return console.log("changeParentColor() 参数必须是一个标签对象！"),!1;e.classList.add("js-active"),"LI"==e.parentElement.parentElement.nodeName&&A(e.parentElement.parentElement)}p.querySelector(".parent-level")||(p.children[0].style.paddingLeft="0"),s=0,h.onclick=function(){var e=document.documentElement.clientWidth;1==s?(this.children[0].setAttribute("class","iconfont icon-arrLeft"),a.style.width=e>750?"280px":"60%",a.classList.remove("js-switch-button"),u.style.padding="15px 15px 0 295px",s=0):(this.children[0].setAttribute("class","iconfont icon-closeC"),a.style.width="0",a.style.padding="0",a.classList.add("js-switch-button"),a.classList.add("js-switch-button"),u.style.padding="15px 15px 0",s=1)},v.onclick=function(){var e=L();if(f.querySelector(".icon-catalogClose")){this.setAttribute("class","catalog-button iconfont icon-catalogOpen");for(var t=0,n=b.length;t<n;t++)1==e?b[t].setAttribute("class","iconfont icon-openA"):2==e?b[t].setAttribute("class","iconfont icon-openB"):b[t].setAttribute("class","iconfont icon-openC");for(var o=0,i=y.length;o<i;o++)y[o].setAttribute("class","js-open")}else{this.setAttribute("class","catalog-button iconfont icon-catalogClose");for(var c=0,l=b.length;c<l;c++)1==e?b[c].setAttribute("class","iconfont icon-closeA"):2==e?b[c].setAttribute("class","iconfont icon-closeB"):b[c].setAttribute("class","iconfont icon-closeC");for(var r=0,s=y.length;r<s;r++)y[r].setAttribute("class","js-close")}},function(){for(var e=function(e,t){b[e].onclick=function(){var t=L(),n="",o="";1==t?(n="iconfont icon-closeA",o="iconfont icon-openA"):2==t?(n="iconfont icon-closeB",o="iconfont icon-openB"):(n="iconfont icon-closeC",o="iconfont icon-openC"),"js-open"==b[e].nextElementSibling.nextElementSibling.getAttribute("class")?(b[e].setAttribute("class",n),b[e].nextElementSibling.nextElementSibling.setAttribute("class","js-close")):(b[e].setAttribute("class",o),b[e].nextElementSibling.nextElementSibling.setAttribute("class","js-open")),p.querySelector(".js-open")||f.children[0].setAttribute("class","catalog-button iconfont icon-catalogClose"),p.querySelector(".js-close")||f.children[0].setAttribute("class","catalog-button iconfont icon-catalogOpen")}},t=0,n=b.length;t<n;t++)e(t)}(),function(){for(var e=function(e,t){g[e].onclick=function(){for(var t=p.querySelectorAll(".js-active"),n=0,o=t.length;n<o;n++)t[n].classList.remove("js-active");this.parentElement.classList.add("js-active"),A(g[e].parentElement)}},t=0,n=g.length;t<n;t++)e(t)}(),function(){for(var e=d.querySelectorAll("h2,h3,h4,h5,h6"),t=[],n=0,o=e.length;n<o;n++)t.push(e[n].offsetTop-50);u.onscroll=function(){for(var e=u.scrollTop,n=0,o=t.length;n<o;n++)if(t[n]<=e){for(var i=p.querySelectorAll(".js-active"),c=0,l=i.length;c<l;c++)i[c].classList.remove("js-active");g[n].parentElement.classList.add("js-active"),A(g[n].parentElement)}}}(),function(){var e=0;m.onclick=function(){0==e?(m.children[0].setAttribute("class","iconfont icon-night"),document.body.classList.add("js-night-view"),e=1,a.style.borderColor="#3E3D42"):(m.children[0].setAttribute("class","iconfont icon-sun"),document.body.classList.remove("js-night-view"),e=0,a.style.borderColor="#ccc")};var t=a.getAttribute("border-color");h.onmouseover=function(){a.style.borderColor="#3cae7c"},h.onmouseout=function(){a.style.borderColor=t}}();var S,x,k,q=document.querySelector(".index"),C=p.querySelectorAll("p");function L(){for(var e=void 0,t=document.getElementsByName("catalogStyle"),n=0,o=t.length;n<o;n++)if("checked"==t[n].getAttribute("checked")){e=t[n].value;break}return e}!function(){var e=0;q.onclick=function(){if(1==e){this.children[0].setAttribute("class","iconfont icon-indexA");for(var t=0,n=C.length;t<n;t++)C[t].classList.remove("js-close");e=0}else{this.children[0].setAttribute("class","iconfont icon-indexB");for(var o=0,i=C.length;o<i;o++)C[o].classList.add("js-close");e=1}}}(),function(){for(var e=document.querySelector(".structure-child").querySelectorAll("li"),t=document.querySelector(".structure-child").querySelectorAll("input"),n=function(n,o){e[n].onclick=function(){for(var o=0,i=b.length;o<i;o++){var c=b[o].nextElementSibling.nextElementSibling.getAttribute("class");0==n?"js-close"==c?b[o].setAttribute("class","iconfont icon-closeA"):b[o].setAttribute("class","iconfont icon-openA"):1==n?"js-close"==c?b[o].setAttribute("class","iconfont icon-closeB"):b[o].setAttribute("class","iconfont icon-openB"):"js-close"==c?b[o].setAttribute("class","iconfont icon-closeC"):b[o].setAttribute("class","iconfont icon-openC")}for(var l=0,r=t.length;l<r;l++)"checked"==t[l].getAttribute("checked")&&t[l].removeAttribute("checked");e[n].children[0].setAttribute("checked","checked")}},o=0,i=e.length;o<i;o++)n(o)}(),S=document.querySelector(".search"),x=document.querySelector(".search-result"),k=S.nextElementSibling,S.onfocus=function(){S.onkeyup=function(){var e=S.value.replace(/\s+/g,"");e?function(){x.style.display="block",k.style.display="block";var t=function(e){if("string"!=typeof e)return console.log("comparison() 参数必须是一个字符串"),!1;e=e.toLowerCase();for(var t="",n=0,o=g.length;n<o;n++)-1!=g[n].innerText.replace(/\s+/g,"").toLowerCase().indexOf(e)&&(t+='\n<a href="'+g[n].getAttribute("href")+'">'+g[n].innerText+"</a>\n");return""==t&&(t='\n<i class="iconfont icon-search"></i>\n<span>目录中暂无相关搜索结果</span>\n<span>试试 Ctrl+F  在全文档搜索</span>\n'),t}(e);x.innerHTML=t;for(var n=x.querySelectorAll("a"),o=function(e,t){n[e].onclick=function(){n[e].classList.add("js-active")}},i=0,c=n.length;i<c;i++)o(i)}():(x.style.display="none",k.style.display="none")}},k.onclick=function(){this.style.display="none",x.style.display="none",S.value=""}}}]);
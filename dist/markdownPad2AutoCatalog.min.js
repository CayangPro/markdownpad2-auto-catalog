/*
|--------------------------------------------------------------------------
| MarkdownPad2AutoCatalog
| MarkdownPad2 编辑器导出 html 文件时自动生成左侧目录插件
|--------------------------------------------------------------------------
| 插件地址：
| GitHub https://github.com/cayxc/MarkdownPad2AutoCatalog
| Gitee  https://gitee.com/cayxc/MarkdownPad2AutoCatalog
|
*/
!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="dist/",n(n.s=0)}([function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var l=void 0,s=void 0,c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l=this,"boolean"!=typeof t||"boolean"!=typeof n||"number"!=typeof i?(this.openDark=!1,this.showIndex=!0,this.indexStyle=1,s=1,console.error("传入参数类型有误，已按照默认配置执行，三个参数类型依次为：Boolean, Boolean, Number")):(this.openDark=t,this.showIndex=n,this.indexStyle=i,s=i),null==document.querySelector("#left-container")&&this.replaceOld(),this.leftElement=document.querySelector("#left-container"),this.rightElement=document.querySelector("#right-container"),this.content=document.querySelector("#content"),this.topElement=document.querySelector(".top-container"),this.listElement=document.querySelector(".list-wrapper"),this.switchButton=document.querySelector("#switch-button"),this.switchListButton=document.querySelector(".catalog-button"),this.viewModeButton=document.querySelector(".mode"),this.allIcon=this.listElement.children[0].querySelectorAll("i"),this.allChildLevel=this.listElement.children[0].querySelectorAll("ul"),this.allCatalogElement=this.listElement.querySelectorAll("a"),this.showIndex=document.querySelector(".index"),this.allIndex=this.listElement.querySelectorAll("p"),this.haveChileLevel(),this.switchCatalog(),this.switchCatalogList(),this.switchParentCatalog(),this.singLeCatalogClick(),this.catalogTrack(),this.nightView(),this.showCatalogIndex(),this.choseCatalogStyle(),this.searchCatalog()}return o(e,[{key:"createContent",value:function(){var e=document.body.innerHTML;document.body.innerHTML="",document.body.style.overflow="hidden",this.openDark&&(document.body.className="js-night-view");var t=document.createElement("div"),n=document.createElement("div");t.id="left-container",n.id="right-container";var i=void 0;i=this.showIndex?'<i class="iconfont icon-indexA"></i>':'<i class="iconfont icon-indexB"></i>';for(var o="",l=1;l<=3;l++)this.indexStyle==l?o+='<li class="active" ><span>样式 '+l+"</span></li>":o+="<li><span>样式 "+l+"</span></li>";t.innerHTML='\n<div class="top-container">\n        <i class="catalog-button iconfont icon-catalogClose"></i>\n        <div class="search-container">\n            <input type="text" class="search" name="search" placeholder="输入关键字搜索 . . .">\n            <i class="search-icon iconfont icon-cancel"></i>\n        </div>\n        <div class="search-result"></div>\n    </div>\n    <div id="list-container">\n        <div class="list-wrapper">\n        </div>\n    </div>\n    <div class="bottom-container">\n        <div class="mode-container">\n            <div class="mode">\n                <i class="iconfont icon-sun"></i>\n            </div>\n            <div class="index">\n'+i+'            \n</div>\n            <div class="structure">\n                <i class="iconfont icon-process"></i>\n                <ul class="structure-child">\n'+o+'                </ul>\n            </div>\n            <div class="color" style="display: none;">\n                <i class="iconfont icon-color"></i>\n                <div class="color-child">\n                    <span>自定义颜色</span>\n                    <input type="color">\n                </div>\n            </div>\n        </div>\n    </div>\n   <div id="switch-button">\n   <i class="iconfont icon-arrLeft"></i>\n   </div>\n',n.innerHTML='\n<div id="content">\n'+e+"\n</div>\n</div>\n",document.body.appendChild(t),document.body.appendChild(n);this.noteTips("div",'\n<p class="note-tips">\n 本文档经过 MarkdownPad2AutoCatalog 目录生成插件转换生成&emsp;插件详情：<a href="https://github.com/cayxc/MarkdownPad2AutoCatalog" target="_blank"> GitHub地址</a>&emsp;<a href="https://gitee.com/cayxc/MarkdownPad2AutoCatalog" target="_blank">Gitee地址</a></p>\n',"content")}},{key:"changeTag",value:function(){var e=document.querySelectorAll("h1");if(e.length>1){for(var t=document.querySelectorAll("h2,h3,h4,h5"),n=1,i=e.length;n<i;n++){var o=document.createElement("h2");o.innerHTML=e[n].innerHTML,e[n].parentNode.replaceChild(o,e[n])}for(var l=0,s=t.length;l<s;l++){var c="h"+(parseInt(t[l].nodeName.slice(1))+1),r=document.createElement(c);r.innerHTML=t[l].innerHTML,t[l].parentNode.replaceChild(r,t[l])}}}},{key:"getTagNumber",value:function(e){if("object"==(void 0===e?"undefined":i(e)))return Number(e.nodeName.slice(1));console.error("getTagNumber() 调用时参数类型错误，必须是一个h标签的对象集合！")}},{key:"findStrFre",value:function(e,t){if("string"==typeof e&&"string"==typeof e){for(var n=e.indexOf(t),i=0;-1!==n;)i++,n=e.indexOf(t,n+1);return i}console.error("findStrFre() 调用时参数类型错误！")}},{key:"levelTagArr",value:function(e){if(e<1||e>5||"number"!=typeof e)console.error("levelTagArr() 调用时参数类型错误！");else{for(var t=document.querySelectorAll("h2,h3,h4,h5,h6"),n=[],i=[],o=[],l=[],s=[],c=0,r=t.length;c<r;c++){switch(this.findStrFre(t[c].id,".")){case 0:n.push(t[c]);break;case 1:i.push(t[c]);break;case 2:o.push(t[c]);break;case 3:l.push(t[c]);break;case 4:s.push(t[c]);break;default:return}}switch(e){case 1:return n;case 2:return i;case 3:return o;case 4:return l;case 5:return s;default:return}}}},{key:"setLevelNumber",value:function(e){if("object"==(void 0===e?"undefined":i(e))){var t=e.id;if(-1==t.lastIndexOf("."))return"level-"+(parseInt(t.slice(6))+1);var n=t.lastIndexOf(".");return t.slice(0,n)+"."+(parseInt(t.slice(n+1))+1)}console.error("setLevelNumber() 调用时参数类型错误，必须是一个h标签的对象集合！")}},{key:"setTagLevel",value:function(){this.changeTag();var e=document.querySelectorAll("h2,h3,h4,h5,h6"),t=e.length;if(0!=t){if(1==t&&(e[0].id="level-1"),t>1){e[0].id="level-1";var n=this.getTagNumber(e[1])-this.getTagNumber(e[0]);e[1].id=n<=0?this.setLevelNumber(e[0]):e[0].id+".1";for(var i=2,o=t-1;i<=o;i++){var l=this.getTagNumber(e[i]),s=this.getTagNumber(e[i-1]);if(l<s)for(var c=i-1;c>=0;c--){var r=this.getTagNumber(e[c])-l;if(1==r){if(!(c>0)){e[i].id=this.setLevelNumber(e[c]);break}if(this.getTagNumber(e[c-1])==l){e[i].id=this.setLevelNumber(e[c-1]);break}}if(0==r){e[i].id=this.setLevelNumber(e[c]);break}}l>s&&(e[i].id=e[i-1].id+".1"),l==s&&(e[i].id=this.setLevelNumber(e[i-1]))}}}else document.querySelector(".list-wrapper").innerHTML='<ul>\n<li style="text-align:center;color: #ccc;font-size:14px;">\n抱歉...<br/>文档中未发现 h1~h6 标签<br/>无法生成目录</p>\n</li>\n</ul>\n'}},{key:"noteTips",value:function(e,t,n){if("string"==typeof e&&"string"==typeof t&&"string"==typeof n){var i=document.createElement(e);i.innerHTML=t,document.getElementById(n).appendChild(i)}else console.error("noteTips() 调用时参数类型错误！")}},{key:"createCatalogue",value:function(){this.setTagLevel();var e=document.querySelector(".list-wrapper"),t=document.createElement("ul"),n=void 0;n=this.showIndex?"":"js-close";for(var i=1;i<=5;i++){var o=this.levelTagArr(i),l=o.length;if(0==l)break;if(1==i)for(var s=0,c=l;s<c;s++){var r=document.createElement("li");r.innerHTML='\n<a href="'+window.location.pathname+"#"+o[s].id+'" class='+o[s].id+'>\n<p class="'+n+'">'+o[s].id.slice(6)+"</p>\n<span>"+o[s].innerText+"</span></a>\n",t.appendChild(r),e.appendChild(t)}if(i>1)for(var a=0,u=l;a<u;a++)for(var d=this.levelTagArr(i-1),h=0,f=d.length;h<f;h++){if(o[a].id.slice(6,o[a].id.lastIndexOf("."))==d[h].id.slice(6)){var v=d[h].id,p=document.getElementsByClassName(v)[0].parentNode;p.setAttribute("class","parent-level");var m=document.createElement("li");m.innerHTML='\n<a href="'+window.location.pathname+"#"+o[a].id+'" class='+o[a].id+'>\n<p class="'+n+'">'+o[a].id.slice(6)+"</p>\n<span>"+o[a].innerText+"</span></a>\n";var g=p.querySelector("ul");if(null!==g)g.appendChild(m);else{(g=document.createElement("ul")).setAttribute("class","js-close"),g.appendChild(m),p.appendChild(g);var y=document.createElement("i"),b=void 0;switch(this.indexStyle){case 1:b="iconfont icon-closeA";break;case 2:b="iconfont icon-closeB";break;case 3:b="iconfont icon-closeC";break;default:b="iconfont icon-closeA"}y.setAttribute("class",b),p.insertBefore(y,p.childNodes[0])}break}}}}},{key:"replaceOld",value:function(){this.createContent(),this.createCatalogue(),document.querySelector(".list-wrapper").querySelector("li").classList.add("js-active")}},{key:"haveChileLevel",value:function(){this.listElement.querySelector(".parent-level")||(this.listElement.children[0].style.paddingLeft="0")}},{key:"switchCatalog",value:function(){var e=this.switchButton,t=this.leftElement,n=this.rightElement,i=0;e.onclick=function(){var e=document.documentElement.clientWidth;1==i?(this.children[0].setAttribute("class","iconfont icon-arrLeft"),t.style.width=e>750?"280px":"60%",t.classList.remove("js-switch-button"),n.style.padding="15px 15px 0 295px",i=0):(this.children[0].setAttribute("class","iconfont icon-closeC"),t.style.width="0",t.style.padding="0",t.classList.add("js-switch-button"),t.classList.add("js-switch-button"),n.style.padding="15px 15px 0",i=1)}}},{key:"switchCatalogList",value:function(){var e=this.switchListButton,t=this.topElement,n=this.allIcon,i=this.allChildLevel;e.onclick=function(){if(t.querySelector(".icon-catalogClose")){this.setAttribute("class","catalog-button iconfont icon-catalogOpen");for(var e=0,o=n.length;e<o;e++)1==s?n[e].setAttribute("class","iconfont icon-openA"):2==s?n[e].setAttribute("class","iconfont icon-openB"):n[e].setAttribute("class","iconfont icon-openC");for(var l=0,c=i.length;l<c;l++)i[l].setAttribute("class","js-open")}else{this.setAttribute("class","catalog-button iconfont icon-catalogClose");for(var r=0,a=n.length;r<a;r++)1==s?n[r].setAttribute("class","iconfont icon-closeA"):2==s?n[r].setAttribute("class","iconfont icon-closeB"):n[r].setAttribute("class","iconfont icon-closeC");for(var u=0,d=i.length;u<d;u++)i[u].setAttribute("class","js-close")}}}},{key:"switchParentCatalog",value:function(){for(var e=this.allIcon,t=this.topElement,n=document.querySelector(".list-wrapper").children[0].childNodes,i=[],o=function(o,l){e[o].onclick=function(){var l=void 0,c=void 0;switch(s){case 1:l="iconfont icon-closeA",c="iconfont icon-openA";break;case 2:l="iconfont icon-closeB",c="iconfont icon-openB";break;case 3:l="iconfont icon-closeC",c="iconfont icon-openC";break;default:l="iconfont icon-closeA",c="iconfont icon-openA"}"js-open"===e[o].nextElementSibling.nextElementSibling.getAttribute("class")?(e[o].setAttribute("class",l),e[o].nextElementSibling.nextElementSibling.setAttribute("class","js-close")):(e[o].setAttribute("class",c),e[o].nextElementSibling.nextElementSibling.setAttribute("class","js-open"));for(var r=0,a=n.length;r<a;r++){var u=n[r].querySelector("ul");i[r]=null==u?null:u.getAttribute("class")}i.includes("js-open")?t.children[0].setAttribute("class","catalog-button iconfont icon-catalogOpen"):t.children[0].setAttribute("class","catalog-button iconfont icon-catalogClose")}},l=0,c=e.length;l<c;l++)o(l)}},{key:"changeParentColor",value:function(e){if("object"!==(void 0===e?"undefined":i(e)))return console.error("changeParentColor() 参数必须是一个标签对象！"),!1;e.classList.add("js-active"),"LI"==e.parentElement.parentElement.nodeName&&this.changeParentColor(e.parentElement.parentElement)}},{key:"singLeCatalogClick",value:function(){for(var e=this.allCatalogElement,t=this.listElement,n=function(n,i){e[n].onclick=function(){for(var i=t.querySelectorAll(".js-active"),o=0,s=i.length;o<s;o++)i[o].classList.remove("js-active");this.parentElement.classList.add("js-active"),l.changeParentColor(e[n].parentElement)}},i=0,o=e.length;i<o;i++)n(i)}},{key:"catalogTrack",value:function(){for(var e=this.content.querySelectorAll("h2,h3,h4,h5,h6"),t=this.rightElement,n=this.listElement,i=this.allCatalogElement,o=[],s=0,c=e.length;s<c;s++)o.push(e[s].offsetTop-50);t.onscroll=function(){for(var e=t.scrollTop,s=0,c=o.length;s<c;s++)if(o[s]<=e){for(var r=n.querySelectorAll(".js-active"),a=0,u=r.length;a<u;a++)r[a].classList.remove("js-active");i[s].parentElement.classList.add("js-active"),l.changeParentColor(i[s].parentElement)}}}},{key:"nightView",value:function(){var e=void 0;e=null!=document.querySelector(".js-night-view");var t=this.viewModeButton,n=this.leftElement,i=this.switchButton;t.onclick=function(){e?(t.children[0].setAttribute("class","iconfont icon-sun"),document.body.classList.remove("js-night-view"),e=!1,n.style.borderColor="#ccc"):(t.children[0].setAttribute("class","iconfont icon-night"),document.body.classList.add("js-night-view"),e=!0,n.style.borderColor="#3E3D42")};var o=n.getAttribute("border-color");i.onmouseover=function(){n.style.borderColor="#3cae7c"},i.onmouseout=function(){n.style.borderColor=o}}},{key:"showCatalogIndex",value:function(){var e=0,t=this.allIndex;this.showIndex.onclick=function(){if(1==e){this.children[0].setAttribute("class","iconfont icon-indexA");for(var n=0,i=t.length;n<i;n++)t[n].classList.remove("js-close");e=0}else{this.children[0].setAttribute("class","iconfont icon-indexB");for(var o=0,l=t.length;o<l;o++)t[o].classList.add("js-close");e=1}}}},{key:"choseCatalogStyle",value:function(){for(var e=document.querySelector(".structure-child").querySelectorAll("li"),t=this.allIcon,n=function(n,i){e[n].onclick=function(){document.querySelector(".structure-child").querySelector(".active").removeAttribute("class"),e[n].setAttribute("class","active");for(var i=0,o=t.length;i<o;i++){var l=t[i].nextElementSibling.nextElementSibling.getAttribute("class");0==n?("js-close"==l?t[i].setAttribute("class","iconfont icon-closeA"):t[i].setAttribute("class","iconfont icon-openA"),s=1):1==n?("js-close"==l?t[i].setAttribute("class","iconfont icon-closeB"):t[i].setAttribute("class","iconfont icon-openB"),s=2):("js-close"==l?t[i].setAttribute("class","iconfont icon-closeC"):t[i].setAttribute("class","iconfont icon-openC"),s=3)}}},i=0,o=e.length;i<o;i++)n(i)}},{key:"comparison",value:function(e){if("string"!=typeof e)return console.error("comparison() 参数必须是一个字符串"),!1;e=e.toLowerCase();for(var t="",n=this.allCatalogElement,i=0,o=n.length;i<o;i++){if(-1!=n[i].innerText.replace(/\s+/g,"").toLowerCase().indexOf(e))t+='\n<a href="'+n[i].getAttribute("href")+'">'+n[i].innerText+"</a>\n"}return""==t&&(t='\n<i class="iconfont icon-search"></i>\n<span>目录中暂无相关搜索结果</span>\n<span>试试 Ctrl+F  在全文档搜索</span>\n'),t}},{key:"searchCatalog",value:function(){var e=document.querySelector(".search"),t=document.querySelector(".search-result"),n=e.nextElementSibling;e.onfocus=function(){e.onkeyup=function(){var i=e.value.replace(/\s+/g,"");i?function(){t.style.display="block",n.style.display="block";var e=l.comparison(i);t.innerHTML=e;for(var o=t.querySelectorAll("a"),s=function(e,t){o[e].onclick=function(){o[e].classList.add("js-active")}},c=0,r=o.length;c<r;c++)s(c)}():(t.style.display="none",n.style.display="none")}},n.onclick=function(){this.style.display="none",t.style.display="none",e.value=""}}}]),e}();window.onload=function(){new c}}]);